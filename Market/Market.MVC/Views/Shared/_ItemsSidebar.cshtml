<div class="sidebar-widget">
    <div class="row">
        <div class="col-12">
            <span class="sidebar-widget-title--sm">Keyword</span>
            <div class="input-group mb-4">
                <input type="text" placeholder="Search ..." class="form-control" name="">
                <span class="input-group-append"> <button class="btn btn-primary"> <i class="las la-search"></i></button></span>
            </div>
            <hr>
            <span class="sidebar-widget-title--sm">Category</span>
            <!-- Category -->
            <div class="custom-control custom-checkbox mb-2">
                <input type="checkbox" class="custom-control-input product-type-checkbox" id="webTemplates" data-type="0">
                <label class="custom-control-label w-100" for="webTemplates">Web</label>
            </div>
            <div class="custom-control custom-checkbox mb-2">
                <input type="checkbox" class="custom-control-input product-type-checkbox" id="graphics" data-type="1">
                <label class="custom-control-label w-100" for="graphics">Graphics</label>
            </div>
            <div class="custom-control custom-checkbox mb-2">
                <input type="checkbox" class="custom-control-input product-type-checkbox" id="fonts" data-type="2">
                <label class="custom-control-label w-100" for="fonts">Fonts</label>
            </div>
            <hr> <span class="sidebar-widget-title--sm">Price range</span>
            <div class="price-range d-flex justify-content-between align-items-center">
                <div class="input-group">
                    <div class="input-group-prepend">
                        <div class="input-group-text">$</div>
                    </div>
                    <input type="text" id="price-min-input" name="price-min" data-toggle="dropdown" class="form-control rounded-right" placeholder="Min" value="">
                    <ul id="price-min" class="dropdown-menu">
                        <li><a href="#" data-value="5" data-toggle="dropdown">Min Price</a></li>
                        <li><a href="#" data-value="10" data-toggle="dropdown">10</a></li>
                        <li><a href="#" data-value="50" data-toggle="dropdown">50</a></li>
                    </ul>
                </div>
                <div class="mx-1">
                    <p class="mt-3"> - </p>
                </div>
                <div class="input-group">
                    <div class="input-group-prepend">
                        <div class="input-group-text">$</div>
                    </div>
                    <input type="text" id="price-max-input" name="price-max" data-toggle="dropdown" class="form-control rounded-right" placeholder="Max" value="">
                    <ul id="price-max" class="dropdown-menu">
                        <li><a href="#" data-value="500" data-toggle="dropdown">Max Price</a></li>
                        <li><a href="#" data-value="50" data-toggle="dropdown">50</a></li>
                        <li><a href="#" data-value="100" data-toggle="dropdown">100</a></li>
                    </ul>
                </div>
                <div class="ml-1">
                    <button class="btn btn-primary px-2" type="button"><i class="las la-search"></i></button>
                </div>
            </div>
            @* <hr> <span class="sidebar-widget-title--sm">Tags</span> *@
            @* <div class="tags"> <a href="#" class="badge badge-soft-success text-success mb-1">CSS</a> <a href="#" class="badge badge-soft-success text-success mb-1">Bootstrap</a> <a href="#" class="badge badge-soft-success text-success mb-1">WordPress</a> <a href="#" class="badge badge-soft-success text-success mb-1">Digital</a> </div> *@
            @* <hr> *@
            @* <span class="sidebar-widget-title--sm">Rating</span> *@
            @* <label class="custom-control custom-checkbox"> *@
            @*     <input type="checkbox" class="custom-control-input"> *@
            @*     <div class="custom-control-label text-primary"> *@
            @*         <i class="las la-star"></i> <i class="las la-star"></i> <i class="las la-star"></i> *@
            @*         <i class="las la-star"></i> <i class="las la-star"></i> *@
            @*     </div> *@
            @* </label> *@
            @* *@
            @* <label class="custom-control custom-checkbox"> *@
            @*     <input type="checkbox" class="custom-control-input"> *@
            @*     <div class="custom-control-label text-primary"> *@
            @*         <i class="las la-star"></i> <i class="las la-star"></i> <i class="las la-star"></i> *@
            @*         <i class="las la-star"></i> *@
            @*     </div> *@
            @* </label> *@
            @* *@
            @* <label class="custom-control custom-checkbox"> *@
            @*     <input type="checkbox" class="custom-control-input"> *@
            @*     <div class="custom-control-label text-primary"> *@
            @*         <i class="las la-star"></i> <i class="las la-star"></i> <i class="las la-star"></i> *@
            @* *@
            @*     </div> *@
            @* </label> *@
            @* *@
            @* <label class="custom-control custom-checkbox"> *@
            @*     <input type="checkbox" class="custom-control-input"> *@
            @*     <div class="custom-control-label text-primary"> *@
            @*         <i class="las la-star"></i> <i class="las la-star"></i> *@
            @*     </div> *@
            @* </label> *@

        </div>
    </div>
</div>
<script>
    async function addToCart(productId) {
        try {
            const response = await fetch(`/Cart/AddItemToCart/${productId}`, {
                method: 'POST'
            });

            if (response.ok) {
                alert("Товар добавлен в корзину!");
            } else {
                const err = await response.text();
                alert("Ошибка: " + err);
            }
        } catch (error) {
            console.error("Ошибка при добавлении в корзину:", error);
            alert("Произошла ошибка.");
        }
    }

    // Обработка фильтрации по типам товаров
    document.addEventListener('DOMContentLoaded', function() {
        const checkboxes = document.querySelectorAll('.product-type-checkbox');

        checkboxes.forEach(checkbox => {
            checkbox.addEventListener('change', function() {
                const selectedTypes = Array.from(checkboxes)
                    .filter(cb => cb.checked)
                    .map(cb => cb.dataset.type);

                // Получаем текущий URL и параметры
                const url = new URL(window.location.href);
                const searchParams = new URLSearchParams(url.search);

                // Обновляем параметр productTypes
                if (selectedTypes.length > 0) {
                    searchParams.set('productTypes', selectedTypes.join(','));
                } else {
                    searchParams.delete('productTypes');
                }

                // Сбрасываем страницу на первую при изменении фильтров
                searchParams.set('page', '1');

                // Обновляем URL и перезагружаем страницу
                url.search = searchParams.toString();
                window.location.href = url.toString();
            });
        });
    });

    async function toggleLike(productId) {
        try {
            const response = await fetch(`/Like/Toggle/${productId}`, {
                method: 'POST'
            });

            if (response.ok) {
                const icon = document.querySelector(`[data-product-id='${productId}'] i`);
                icon.classList.toggle('text-danger');
            } else {
                const err = await response.text();
                alert("Ошибка: " + err);
            }
        } catch (error) {
            console.error("Ошибка при лайке:", error);
            alert("Произошла ошибка.");
        }
    }
</script>
